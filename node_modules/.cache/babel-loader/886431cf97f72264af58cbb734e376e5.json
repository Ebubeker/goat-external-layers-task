{"remainingRequest":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/babel-loader/lib/index.js!/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/eslint-loader/index.js??ref--13-0!/home/ebubeker/Desktop/programming/work tasks/goat/app/client/src/store/modules/app.js","dependencies":[{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/src/store/modules/app.js","mtime":1657798986512},{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/cache-loader/dist/cjs.js","mtime":1657636581841},{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/babel-loader/lib/index.js","mtime":1657636581481},{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/eslint-loader/index.js","mtime":1657636581253}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport _defineProperty from \"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"core-js/modules/es6.object.keys\";\nimport _toConsumableArray from \"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/web.dom.iterable\";\n\nvar _actions, _mutations;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport ApiService from \"../../services/api.service\";\nimport { getField, updateField } from \"vuex-map-fields\";\nimport { GET_APP_CONFIG, GET_OPENAPI_CONFIG, GET_USER_CUSTOM_DATA } from \"../actions.type\";\nimport { SET_APP_CONFIG, SET_ERROR, SET_OPENAPI_CONFIG, SET_POI_ICONS, SET_USER_CUSTOM_DATA } from \"../mutations.type\";\nimport { errorMessage } from \"../../utils/Helpers\";\nimport SwaggerParser from \"@apidevtools/swagger-parser\";\nvar state = {\n  errors: null,\n  appConfig: null,\n  openapiConfig: null,\n  uploadedData: [],\n  poiIcons: {},\n  layerTabIndex: 0,\n  calculationMode: {\n    values: [\"default\", \"scenario\", \"comparison\"],\n    active: \"default\"\n  },\n  isRecomputingHeatmap: false,\n  scenarioLayerEditModeColor: \"#283648\"\n};\nvar getters = {\n  appConfig: function appConfig(state) {\n    return state.appConfig;\n  },\n  openapiConfig: function openapiConfig(state) {\n    return state.openapiConfig;\n  },\n  uploadedData: function uploadedData(state) {\n    return state.uploadedData;\n  },\n  calculationMode: function calculationMode(state) {\n    return state.calculationMode;\n  },\n  appColor: function appColor(state) {\n    return state.appConfig.app_ui.base_color;\n  },\n  scenarioLayerEditModeColor: function scenarioLayerEditModeColor(state) {\n    return state.scenarioLayerEditModeColor;\n  },\n  routingProfiles: function routingProfiles(state) {\n    var routingProfiles = {};\n    var routing = state.appConfig.routing;\n    routing.forEach(function (r) {\n      routingProfiles[r.type] = r;\n    });\n    return routingProfiles;\n  },\n  poisAoisTree: function poisAoisTree(state) {\n    var treeStruct = [];\n    var poiAoiGroups = [].concat(_toConsumableArray(state.appConfig.poi_groups), _toConsumableArray(state.appConfig.aoi_groups));\n    poiAoiGroups.forEach(function (group, groupIndex) {\n      var groupName = Object.keys(group)[0];\n      var restructuredChildren = [];\n      var children = group[groupName].children;\n      var hasUserData = false;\n      children.forEach(function (child) {\n        var childName = Object.keys(child)[0];\n\n        var restructuredChild = _objectSpread({\n          value: childName,\n          hasUserData: false,\n          sensitivity: 300000\n        }, child[childName]); // Check if the has user data.\n\n\n        state.uploadedData.forEach(function (userData) {\n          if (userData.state === true && userData.category === childName) {\n            hasUserData = true;\n            restructuredChild.hasUserData = true;\n          }\n        });\n        restructuredChildren.push(restructuredChild);\n      });\n      var groupTreeStruct = {\n        id: groupIndex,\n        value: groupName,\n        hasUserData: hasUserData,\n        icon: group[groupName].icon,\n        color: group[groupName].color,\n        children: restructuredChildren\n      };\n      treeStruct.push(groupTreeStruct);\n    });\n    return treeStruct;\n  },\n  poisTreeOnlyChildren: function poisTreeOnlyChildren(state, getters) {\n    var treeStruct = {};\n    getters.poisAoisTree.forEach(function (group) {\n      group.children.forEach(function (child) {\n        if (getters.poiIcons[child.value]) {\n          treeStruct[child.value] = child;\n        }\n      });\n    });\n    return treeStruct;\n  },\n  // Only Pois\n  poisConfig: function poisConfig(state) {\n    var poiGroups = state.appConfig.poi_groups;\n    var poisConfig = {};\n    poiGroups.forEach(function (group) {\n      var groupName = Object.keys(group)[0];\n      group[groupName].children.forEach(function (child) {\n        var childName = Object.keys(child)[0];\n        poisConfig[childName] = {\n          icon: child[childName].icon,\n          color: child[childName].color,\n          group: groupName\n        };\n      });\n    });\n    return poisConfig;\n  },\n  // Only Aois\n  aoisConfig: function aoisConfig(state) {\n    var aoisGroups = state.appConfig.aoi_groups;\n    var aoisConfig = {};\n    aoisGroups.forEach(function (group) {\n      var groupName = Object.keys(group)[0];\n      group[groupName].children.forEach(function (child) {\n        var childName = Object.keys(child)[0];\n        aoisConfig[childName] = {\n          icon: child[childName].icon,\n          color: child[childName].color,\n          group: groupName\n        };\n      });\n    });\n    return aoisConfig;\n  },\n  uploadedStorageSize: function uploadedStorageSize(state) {\n    return state.uploadedData.reduce(function (acc, item) {\n      return acc + item.upload_size;\n    }, 0);\n  },\n  unCalculatedDataUploadIds: function unCalculatedDataUploadIds() {\n    var unCalculatedDataUploadIds = [];\n    state.uploadedData.forEach(function (item) {\n      if (!item.reached_poi_heatmap_computed && item.state === true) {\n        unCalculatedDataUploadIds.push(item.id);\n      }\n    });\n    return unCalculatedDataUploadIds;\n  },\n  isRecomputingHeatmap: function isRecomputingHeatmap(state) {\n    return state.isRecomputingHeatmap;\n  },\n  // eslint-disable-next-line no-unused-vars\n  occupiedStoragePercentage: function occupiedStoragePercentage(state, getters, rootState, rootGetters) {\n    var totalStorage = rootState.auth.user.storage;\n    return getters.uploadedStorageSize * 100 / totalStorage;\n  },\n  poiIcons: function poiIcons(state) {\n    return state.poiIcons;\n  },\n  getField: getField\n};\nvar actions = (_actions = {}, _defineProperty(_actions, GET_APP_CONFIG, function (context) {\n  return new Promise(function (resolve, reject) {\n    ApiService.get(\"/customizations/me\").then(function (response) {\n      context.commit(SET_APP_CONFIG, response.data);\n      context.commit(SET_POI_ICONS, response.data);\n      resolve(response.data);\n    }).catch(function (_ref) {\n      var response = _ref.response;\n      errorMessage(context, response, SET_ERROR);\n      reject(response);\n    });\n  });\n}), _defineProperty(_actions, GET_USER_CUSTOM_DATA, function (context) {\n  return new Promise(function (resolve, reject) {\n    ApiService.get(\"/custom-data/poi\").then(function (response) {\n      context.commit(SET_USER_CUSTOM_DATA, response.data);\n      resolve(response.data);\n    }).catch(function (_ref2) {\n      var response = _ref2.response;\n      errorMessage(context, response, SET_ERROR);\n      reject(response);\n    });\n  });\n}), _defineProperty(_actions, GET_OPENAPI_CONFIG, function (context) {\n  return new Promise(function (resolve, reject) {\n    ApiService.get(\"/openapi.json\").then(function (response) {\n      context.commit(SET_OPENAPI_CONFIG, response.data);\n      SwaggerParser.validate(response.data, function (err, api) {\n        //TODO: Check swagger for validation errors here.\n        resolve(api);\n      });\n    }).catch(function (_ref3) {\n      var response = _ref3.response;\n      errorMessage(context, response, SET_ERROR);\n      reject(response);\n    });\n  });\n}), _actions);\nvar mutations = (_mutations = {\n  updateField: updateField\n}, _defineProperty(_mutations, SET_ERROR, function (state, error) {\n  state.errors = error;\n}), _defineProperty(_mutations, SET_APP_CONFIG, function (state, config) {\n  state.appConfig = config;\n}), _defineProperty(_mutations, SET_POI_ICONS, function (state, config) {\n  var icons = {};\n  var poiAoiGroups = [].concat(_toConsumableArray(config.poi_groups), _toConsumableArray(config.aoi_groups));\n  poiAoiGroups.forEach(function (group) {\n    var groupName = Object.keys(group)[0];\n    var children = group[groupName].children;\n    children.forEach(function (child) {\n      var childName = Object.keys(child)[0];\n      icons[childName] = {\n        icon: child[childName].icon,\n        color: child[childName].color[0]\n      };\n    });\n  });\n  state.poiIcons = icons;\n}), _defineProperty(_mutations, SET_USER_CUSTOM_DATA, function (state, customData) {\n  state.uploadedData = customData;\n}), _defineProperty(_mutations, SET_OPENAPI_CONFIG, function (state, config) {\n  state.openapiConfig = config;\n}), _mutations);\nexport default {\n  namespaced: true,\n  state: state,\n  getters: getters,\n  actions: actions,\n  mutations: mutations\n};",{"version":3,"sources":["/home/ebubeker/Desktop/programming/work tasks/goat/app/client/src/store/modules/app.js"],"names":["ApiService","getField","updateField","GET_APP_CONFIG","GET_OPENAPI_CONFIG","GET_USER_CUSTOM_DATA","SET_APP_CONFIG","SET_ERROR","SET_OPENAPI_CONFIG","SET_POI_ICONS","SET_USER_CUSTOM_DATA","errorMessage","SwaggerParser","state","errors","appConfig","openapiConfig","uploadedData","poiIcons","layerTabIndex","calculationMode","values","active","isRecomputingHeatmap","scenarioLayerEditModeColor","getters","appColor","app_ui","base_color","routingProfiles","routing","forEach","r","type","poisAoisTree","treeStruct","poiAoiGroups","poi_groups","aoi_groups","group","groupIndex","groupName","Object","keys","restructuredChildren","children","hasUserData","child","childName","restructuredChild","value","sensitivity","userData","category","push","groupTreeStruct","id","icon","color","poisTreeOnlyChildren","poisConfig","poiGroups","aoisConfig","aoisGroups","uploadedStorageSize","reduce","acc","item","upload_size","unCalculatedDataUploadIds","reached_poi_heatmap_computed","occupiedStoragePercentage","rootState","rootGetters","totalStorage","auth","user","storage","actions","context","Promise","resolve","reject","get","then","response","commit","data","catch","validate","err","api","mutations","error","config","icons","customData","namespaced"],"mappings":"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","sourcesContent":["import ApiService from \"../../services/api.service\";\nimport { getField, updateField } from \"vuex-map-fields\";\nimport {\n  GET_APP_CONFIG,\n  GET_OPENAPI_CONFIG,\n  GET_USER_CUSTOM_DATA\n} from \"../actions.type\";\nimport {\n  SET_APP_CONFIG,\n  SET_ERROR,\n  SET_OPENAPI_CONFIG,\n  SET_POI_ICONS,\n  SET_USER_CUSTOM_DATA\n} from \"../mutations.type\";\nimport { errorMessage } from \"../../utils/Helpers\";\nimport SwaggerParser from \"@apidevtools/swagger-parser\";\n\nconst state = {\n  errors: null,\n  appConfig: null,\n  openapiConfig: null,\n  uploadedData: [],\n  poiIcons: {},\n  layerTabIndex: 0,\n  calculationMode: {\n    values: [\"default\", \"scenario\", \"comparison\"],\n    active: \"default\"\n  },\n  isRecomputingHeatmap: false,\n  scenarioLayerEditModeColor: \"#283648\"\n};\n\nconst getters = {\n  appConfig: state => state.appConfig,\n  openapiConfig: state => state.openapiConfig,\n  uploadedData: state => state.uploadedData,\n  calculationMode: state => state.calculationMode,\n  appColor: state => {\n    return state.appConfig.app_ui.base_color;\n  },\n  scenarioLayerEditModeColor: state => state.scenarioLayerEditModeColor,\n  routingProfiles: state => {\n    let routingProfiles = {};\n    const routing = state.appConfig.routing;\n    routing.forEach(r => {\n      routingProfiles[r.type] = r;\n    });\n    return routingProfiles;\n  },\n  poisAoisTree: state => {\n    let treeStruct = [];\n    const poiAoiGroups = [\n      ...state.appConfig.poi_groups,\n      ...state.appConfig.aoi_groups\n    ];\n    poiAoiGroups.forEach((group, groupIndex) => {\n      const groupName = Object.keys(group)[0];\n      const restructuredChildren = [];\n      const children = group[groupName].children;\n      let hasUserData = false;\n      children.forEach(child => {\n        const childName = Object.keys(child)[0];\n\n        const restructuredChild = {\n          value: childName,\n          hasUserData: false,\n          sensitivity: 300000,\n          ...child[childName]\n        };\n        // Check if the has user data.\n        state.uploadedData.forEach(userData => {\n          if (userData.state === true && userData.category === childName) {\n            hasUserData = true;\n            restructuredChild.hasUserData = true;\n          }\n        });\n\n        restructuredChildren.push(restructuredChild);\n      });\n      const groupTreeStruct = {\n        id: groupIndex,\n        value: groupName,\n        hasUserData,\n        icon: group[groupName].icon,\n        color: group[groupName].color,\n        children: restructuredChildren\n      };\n      treeStruct.push(groupTreeStruct);\n    });\n    return treeStruct;\n  },\n  poisTreeOnlyChildren: (state, getters) => {\n    let treeStruct = {};\n    getters.poisAoisTree.forEach(group => {\n      group.children.forEach(child => {\n        if (getters.poiIcons[child.value]) {\n          treeStruct[child.value] = child;\n        }\n      });\n    });\n    return treeStruct;\n  },\n  // Only Pois\n  poisConfig: state => {\n    const poiGroups = state.appConfig.poi_groups;\n    let poisConfig = {};\n    poiGroups.forEach(group => {\n      const groupName = Object.keys(group)[0];\n      group[groupName].children.forEach(child => {\n        const childName = Object.keys(child)[0];\n        poisConfig[childName] = {\n          icon: child[childName].icon,\n          color: child[childName].color,\n          group: groupName\n        };\n      });\n    });\n    return poisConfig;\n  },\n  // Only Aois\n  aoisConfig: state => {\n    const aoisGroups = state.appConfig.aoi_groups;\n    let aoisConfig = {};\n    aoisGroups.forEach(group => {\n      const groupName = Object.keys(group)[0];\n      group[groupName].children.forEach(child => {\n        const childName = Object.keys(child)[0];\n        aoisConfig[childName] = {\n          icon: child[childName].icon,\n          color: child[childName].color,\n          group: groupName\n        };\n      });\n    });\n    return aoisConfig;\n  },\n  uploadedStorageSize: state => {\n    return state.uploadedData.reduce((acc, item) => {\n      return acc + item.upload_size;\n    }, 0);\n  },\n  unCalculatedDataUploadIds() {\n    const unCalculatedDataUploadIds = [];\n    state.uploadedData.forEach(item => {\n      if (!item.reached_poi_heatmap_computed && item.state === true) {\n        unCalculatedDataUploadIds.push(item.id);\n      }\n    });\n    return unCalculatedDataUploadIds;\n  },\n  isRecomputingHeatmap: state => state.isRecomputingHeatmap,\n  // eslint-disable-next-line no-unused-vars\n  occupiedStoragePercentage: (state, getters, rootState, rootGetters) => {\n    const totalStorage = rootState.auth.user.storage;\n    return (getters.uploadedStorageSize * 100) / totalStorage;\n  },\n  poiIcons: state => state.poiIcons,\n  getField\n};\n\nconst actions = {\n  [GET_APP_CONFIG](context) {\n    return new Promise((resolve, reject) => {\n      ApiService.get(\"/customizations/me\")\n        .then(response => {\n          context.commit(SET_APP_CONFIG, response.data);\n          context.commit(SET_POI_ICONS, response.data);\n          resolve(response.data);\n        })\n        .catch(({ response }) => {\n          errorMessage(context, response, SET_ERROR);\n          reject(response);\n        });\n    });\n  },\n  [GET_USER_CUSTOM_DATA](context) {\n    return new Promise((resolve, reject) => {\n      ApiService.get(\"/custom-data/poi\")\n        .then(response => {\n          context.commit(SET_USER_CUSTOM_DATA, response.data);\n          resolve(response.data);\n        })\n        .catch(({ response }) => {\n          errorMessage(context, response, SET_ERROR);\n          reject(response);\n        });\n    });\n  },\n  [GET_OPENAPI_CONFIG](context) {\n    return new Promise((resolve, reject) => {\n      ApiService.get(\"/openapi.json\")\n        .then(response => {\n          context.commit(SET_OPENAPI_CONFIG, response.data);\n          SwaggerParser.validate(response.data, (err, api) => {\n            //TODO: Check swagger for validation errors here.\n            resolve(api);\n          });\n        })\n        .catch(({ response }) => {\n          errorMessage(context, response, SET_ERROR);\n          reject(response);\n        });\n    });\n  }\n};\n\nconst mutations = {\n  updateField,\n  [SET_ERROR](state, error) {\n    state.errors = error;\n  },\n  [SET_APP_CONFIG](state, config) {\n    state.appConfig = config;\n  },\n  /**\n   * Restructures the POI icons to be easier to use for openlayers layer styling\n   */\n  [SET_POI_ICONS](state, config) {\n    const icons = {};\n    const poiAoiGroups = [...config.poi_groups, ...config.aoi_groups];\n    poiAoiGroups.forEach(group => {\n      const groupName = Object.keys(group)[0];\n      const children = group[groupName].children;\n      children.forEach(child => {\n        const childName = Object.keys(child)[0];\n        icons[childName] = {\n          icon: child[childName].icon,\n          color: child[childName].color[0]\n        };\n      });\n    });\n    state.poiIcons = icons;\n  },\n  [SET_USER_CUSTOM_DATA](state, customData) {\n    state.uploadedData = customData;\n  },\n  [SET_OPENAPI_CONFIG](state, config) {\n    state.openapiConfig = config;\n  }\n};\n\nexport default {\n  namespaced: true,\n  state,\n  getters,\n  actions,\n  mutations\n};\n"]}]}