{"remainingRequest":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/babel-loader/lib/index.js!/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/vuetify-loader/lib/loader.js??ref--19-0!/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ebubeker/Desktop/programming/work tasks/goat/app/client/src/components/viewer/ol/controls/Search.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/src/components/viewer/ol/controls/Search.vue","mtime":1657636289859},{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/cache-loader/dist/cjs.js","mtime":1657636581841},{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/babel-loader/lib/index.js","mtime":1657636581481},{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/vuetify-loader/lib/loader.js","mtime":1657636582513},{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/cache-loader/dist/cjs.js","mtime":1657636581841},{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/vue-loader/lib/index.js","mtime":1657636582549}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.search\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from \"axios\";\nimport { debounce } from \"../../../../utils/Helpers\";\nimport { geojsonToFeature } from \"../../../../utils/MapUtils\";\nimport { fromLonLat } from \"ol/proj\";\nimport { boundingExtent } from \"ol/extent\";\nimport { getSearchHighlightStyle } from \"../../../../style/OlStyleDefs\";\nimport VectorLayer from \"ol/layer/Vector\";\nimport VectorSource from \"ol/source/Vector\";\nimport Feature from \"ol/Feature\";\nimport Point from \"ol/geom/Point\";\nexport default {\n  props: {\n    map: {\n      type: Object,\n      required: true\n    },\n    color: {\n      type: String\n    },\n    viewbox: {\n      type: Array,\n      required: false\n    }\n  },\n  data: function data() {\n    return {\n      isVisible: false,\n      descriptionLimit: 30,\n      entries: [],\n      model: null,\n      search: null,\n      isLoading: false,\n      highlightLayer: null\n    };\n  },\n  name: \"search\",\n  methods: {\n    zoomToLocation: function zoomToLocation() {\n      var _this = this;\n\n      if (!this.search || !this.model) return;\n      var x1 = parseFloat(this.model.boundingbox[2]);\n      var y1 = parseFloat(this.model.boundingbox[0]);\n      var x2 = parseFloat(this.model.boundingbox[3]);\n      var y2 = parseFloat(this.model.boundingbox[1]);\n      var extent = boundingExtent([fromLonLat([x1, y1]), fromLonLat([x2, y2])]);\n      var feature = new Feature(new Point(fromLonLat([parseFloat(this.model.lon), parseFloat(this.model.lat)])));\n      this.highlightLayer.getSource().clear();\n      this.highlightLayer.getSource().addFeature(feature);\n\n      if (this.model.geojson) {\n        var olFeatures = geojsonToFeature(this.model.geojson, {\n          dataProjection: \"EPSG:4326\",\n          featureProjection: \"EPSG:3857\"\n        });\n        this.highlightLayer.getSource().addFeatures(olFeatures);\n      }\n\n      this.map.getView().fit(extent, {\n        nearest: true,\n        duration: 1000,\n        maxZoom: 19,\n        callback: function callback() {\n          _this.map.render();\n        }\n      });\n    },\n    clearSearch: function clearSearch() {\n      this.entries = [];\n      this.count = 0;\n      this.highlightLayer.getSource().clear();\n    },\n    closeSearch: function closeSearch() {\n      this.clearSearch();\n      this.isVisible = false;\n    }\n  },\n  computed: {\n    items: function items() {\n      return this.entries.map(function (entry) {\n        var subtitle = [];\n        if (entry.class) subtitle.push(entry.class);\n        if (entry.type) subtitle.push(entry.type);\n        return Object.assign({}, entry, {\n          subtitle: subtitle.join(\" - \")\n        });\n      });\n    }\n  },\n  watch: {\n    search: debounce(function () {\n      var _this2 = this;\n\n      if (!this.search) {\n        this.clearSearch();\n        return;\n      } // Items have already been requested\n\n\n      if (this.isLoading) return;\n      this.isLoading = true;\n      var url = \"https://nominatim.openstreetmap.org/search?format=json&addressdetails=1&q=\".concat(this.search, \"&polygon_geojson=0&limit=10\");\n\n      if (this.viewbox.length === 4) {\n        url += \"&viewbox=\".concat(this.viewbox.toString(), \"&bounded=1\");\n      }\n\n      axios.get(url).then(function (response) {\n        _this2.count = response.data.length;\n        _this2.entries = response.data;\n        _this2.isLoading = false;\n      }).catch(function () {\n        _this2.isLoading = false;\n      });\n    }, 500)\n  },\n  created: function created() {\n    this.highlightLayer = new VectorLayer({\n      zIndex: 100,\n      source: new VectorSource(),\n      style: getSearchHighlightStyle\n    });\n    this.map.addLayer(this.highlightLayer);\n  }\n};",{"version":3,"sources":["Search.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"mt-4\">\n    <v-tooltip v-if=\"!isVisible\" right>\n      <template v-slot:activator=\"{ on }\">\n        <v-btn\n          v-if=\"!isVisible\"\n          class=\"search-button\"\n          v-on=\"on\"\n          fab\n          dark\n          x-small\n          @click=\"isVisible = !isVisible\"\n          :color=\"color\"\n        >\n          <v-icon medium>fas fa-search</v-icon>\n        </v-btn>\n      </template>\n      <span>{{ $t(\"map.tooltips.search\") }}</span>\n    </v-tooltip>\n    <v-autocomplete\n      v-if=\"isVisible\"\n      solo\n      rounded\n      style=\"z-index: 3;width:300px;\"\n      v-model=\"model\"\n      :items=\"items\"\n      :loading=\"isLoading\"\n      :label=\"$t('map.tooltips.search')\"\n      :search-input.sync=\"search\"\n      item-text=\"display_name\"\n      append-icon=\"\"\n      clear-icon=\"close\"\n      @click:clear=\"clearSearch\"\n      @change=\"zoomToLocation\"\n      autofocus\n      clearable\n      item-value=\"osm_id\"\n      hide-details\n      hide-no-data\n      no-filter\n      prepend-inner-icon=\"search\"\n      return-object\n      class=\"elevation-4\"\n      :menu-props=\"{ maxHeight: 400 }\"\n    >\n      <template slot=\"append\">\n        <v-icon v-show=\"!search\" v-on:click.stop.prevent=\"closeSearch\" left\n          >chevron_left</v-icon\n        >\n      </template>\n      <template v-slot:item=\"data\">\n        <template v-if=\"typeof data.item !== 'object'\">\n          <v-list-item-content v-text=\"data.item\"></v-list-item-content>\n        </template>\n        <template v-else>\n          <template v-if=\"data.item.icon\">\n            <img :src=\"data.item.icon\" class=\"mr-3\" />\n          </template>\n          <v-list-item-content style=\"z-index: 1;width:220px;\">\n            <v-list-item-title\n              v-html=\"data.item.display_name\"\n            ></v-list-item-title>\n            <v-list-item-subtitle\n              v-if=\"data.item.subtitle\"\n              v-html=\"data.item.subtitle\"\n            ></v-list-item-subtitle>\n          </v-list-item-content>\n        </template>\n      </template>\n      <template slot=\"append-item\"\n        ><div class=\"nominatim-attribution pa-1 mt-2\">\n          <a href=\"http://www.openstreetmap.org/copyright\" target=\"new\"\n            >Â© OpenStreetMap contributors</a\n          >\n        </div>\n      </template>\n    </v-autocomplete>\n  </div>\n</template>\n<script>\nimport axios from \"axios\";\nimport { debounce } from \"../../../../utils/Helpers\";\nimport { geojsonToFeature } from \"../../../../utils/MapUtils\";\nimport { fromLonLat } from \"ol/proj\";\nimport { boundingExtent } from \"ol/extent\";\nimport { getSearchHighlightStyle } from \"../../../../style/OlStyleDefs\";\nimport VectorLayer from \"ol/layer/Vector\";\nimport VectorSource from \"ol/source/Vector\";\nimport Feature from \"ol/Feature\";\nimport Point from \"ol/geom/Point\";\n\nexport default {\n  props: {\n    map: { type: Object, required: true },\n    color: { type: String },\n    viewbox: { type: Array, required: false }\n  },\n  data() {\n    return {\n      isVisible: false,\n      descriptionLimit: 30,\n      entries: [],\n      model: null,\n      search: null,\n      isLoading: false,\n      highlightLayer: null\n    };\n  },\n  name: \"search\",\n  methods: {\n    zoomToLocation() {\n      if (!this.search || !this.model) return;\n      const x1 = parseFloat(this.model.boundingbox[2]);\n      const y1 = parseFloat(this.model.boundingbox[0]);\n      const x2 = parseFloat(this.model.boundingbox[3]);\n      const y2 = parseFloat(this.model.boundingbox[1]);\n      const extent = boundingExtent([\n        fromLonLat([x1, y1]),\n        fromLonLat([x2, y2])\n      ]);\n      const feature = new Feature(\n        new Point(\n          fromLonLat([parseFloat(this.model.lon), parseFloat(this.model.lat)])\n        )\n      );\n      this.highlightLayer.getSource().clear();\n      this.highlightLayer.getSource().addFeature(feature);\n      if (this.model.geojson) {\n        const olFeatures = geojsonToFeature(this.model.geojson, {\n          dataProjection: \"EPSG:4326\",\n          featureProjection: \"EPSG:3857\"\n        });\n        this.highlightLayer.getSource().addFeatures(olFeatures);\n      }\n      this.map.getView().fit(extent, {\n        nearest: true,\n        duration: 1000,\n        maxZoom: 19,\n        callback: () => {\n          this.map.render();\n        }\n      });\n    },\n    clearSearch() {\n      this.entries = [];\n      this.count = 0;\n      this.highlightLayer.getSource().clear();\n    },\n    closeSearch() {\n      this.clearSearch();\n      this.isVisible = false;\n    }\n  },\n  computed: {\n    items() {\n      return this.entries.map(entry => {\n        const subtitle = [];\n        if (entry.class) subtitle.push(entry.class);\n        if (entry.type) subtitle.push(entry.type);\n        return Object.assign({}, entry, {\n          subtitle: subtitle.join(\" - \")\n        });\n      });\n    }\n  },\n  watch: {\n    search: debounce(function() {\n      if (!this.search) {\n        this.clearSearch();\n        return;\n      }\n      // Items have already been requested\n      if (this.isLoading) return;\n      this.isLoading = true;\n      let url = `https://nominatim.openstreetmap.org/search?format=json&addressdetails=1&q=${this.search}&polygon_geojson=0&limit=10`;\n      if (this.viewbox.length === 4) {\n        url += `&viewbox=${this.viewbox.toString()}&bounded=1`;\n      }\n      axios\n        .get(url)\n        .then(response => {\n          this.count = response.data.length;\n          this.entries = response.data;\n          this.isLoading = false;\n        })\n        .catch(() => {\n          this.isLoading = false;\n        });\n    }, 500)\n  },\n  created() {\n    this.highlightLayer = new VectorLayer({\n      zIndex: 100,\n      source: new VectorSource(),\n      style: getSearchHighlightStyle\n    });\n    this.map.addLayer(this.highlightLayer);\n  }\n};\n</script>\n<style lang=\"scss\">\n.search-button {\n  z-index: 1;\n}\n.v-autocomplete__content.v-menu__content {\n  transform-origin: center top !important;\n  transform: scale(0.9) !important;\n}\n.v-autocomplete__content {\n  z-index: 1001 !important;\n}\n.nominatim-attribution {\n  background: rgba(0, 0, 0, 0.5);\n  color: #fff;\n}\n\n.nominatim-attribution a {\n  color: #fff !important;\n  text-decoration: none !important;\n}\n.v-autocomplete__content > div {\n  padding-bottom: 0px !important;\n}\n</style>\n"],"sourceRoot":"src/components/viewer/ol/controls"}]}