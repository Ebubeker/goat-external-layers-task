{"remainingRequest":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/babel-loader/lib/index.js!/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/eslint-loader/index.js??ref--13-0!/home/ebubeker/Desktop/programming/work tasks/goat/app/client/src/store/modules/auth.js","dependencies":[{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/src/store/modules/auth.js","mtime":1657636289863},{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/cache-loader/dist/cjs.js","mtime":1657636581841},{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/babel-loader/lib/index.js","mtime":1657636581481},{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/eslint-loader/index.js","mtime":1657636581253}],"contextDependencies":[],"result":["import _defineProperty from \"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\n\nvar _actions, _mutations;\n\nimport ApiService from \"../../services/api.service\";\nimport JwtService from \"../../services/jwt.service\";\nimport { ACTIVATE_ACCOUNT, CREATE_USER, FORGOT_PASSWORD, GET_USER, LOGIN, LOGOUT, RESET_PASSWORD, TEST_TOKEN } from \"../actions.type\";\nimport { SET_AUTH, PURGE_AUTH, SET_ERROR, SET_USER, SET_MESSAGE } from \"../mutations.type\";\nimport { errorMessage } from \"../../utils/Helpers\";\nimport { getField, updateField } from \"vuex-map-fields\";\nvar state = {\n  errors: null,\n  message: \"\",\n  user: {},\n  isAuthenticated: !!JwtService.getToken()\n};\nvar getters = {\n  currentUser: function currentUser(state) {\n    return state.user;\n  },\n  isAuthenticated: function isAuthenticated(state) {\n    return state.isAuthenticated;\n  },\n  getField: getField\n};\nvar actions = (_actions = {}, _defineProperty(_actions, LOGIN, function (context, credentials) {\n  return new Promise(function (resolve, reject) {\n    ApiService.post(\"/login/access-token\", credentials).then(function (response) {\n      context.commit(SET_AUTH, response.data);\n      resolve(response.data);\n    }).catch(function (_ref) {\n      var response = _ref.response;\n      errorMessage(context, response, SET_ERROR);\n      reject(response);\n    });\n  });\n}), _defineProperty(_actions, FORGOT_PASSWORD, function (context, payload) {\n  return new Promise(function (resolve, reject) {\n    ApiService.post(\"/password-recovery/\".concat(payload.get(\"email\"))).then(function (response) {\n      context.commit(SET_MESSAGE, response.data.msg);\n      resolve(response.data);\n    }).catch(function (_ref2) {\n      var response = _ref2.response;\n      errorMessage(context, response, SET_ERROR);\n      reject(response);\n    });\n  });\n}), _defineProperty(_actions, RESET_PASSWORD, function (context, payload) {\n  return new Promise(function (resolve, reject) {\n    ApiService.post(\"/reset-password\", payload).then(function (response) {\n      context.commit(SET_MESSAGE, response.data.msg);\n      resolve(response.data);\n    }).catch(function (_ref3) {\n      var response = _ref3.response;\n      errorMessage(context, response, SET_ERROR);\n      reject(response);\n    });\n  });\n}), _defineProperty(_actions, CREATE_USER, function (context, payload) {\n  return new Promise(function (resolve, reject) {\n    ApiService.post(\"/users/demo\", payload).then(function (response) {\n      resolve(response.data);\n    }).catch(function (_ref4) {\n      var response = _ref4.response;\n      errorMessage(context, response, SET_ERROR);\n      reject(response);\n    });\n  });\n}), _defineProperty(_actions, TEST_TOKEN, function (context) {\n  return new Promise(function (resolve, reject) {\n    ApiService.post(\"/login/test-token\").then(function (response) {\n      resolve(response.data);\n    }).catch(function (_ref5) {\n      var response = _ref5.response;\n      //Token not valid. Logout and reload.\n      context.commit(PURGE_AUTH);\n      window.location.reload();\n      errorMessage(context, response, SET_ERROR);\n      reject(response);\n    });\n  });\n}), _defineProperty(_actions, GET_USER, function (context) {\n  return new Promise(function (resolve, reject) {\n    ApiService.get(\"/users/me\").then(function (response) {\n      context.commit(SET_USER, response.data);\n      resolve(response.data);\n    }).catch(function (_ref6) {\n      var response = _ref6.response;\n      errorMessage(context, response, SET_ERROR);\n      reject(response);\n    });\n  });\n}), _defineProperty(_actions, ACTIVATE_ACCOUNT, function (context, payload) {\n  return new Promise(function (resolve, reject) {\n    ApiService.post(\"/users/demo/activate?token=\".concat(payload[\"token\"])).then(function (response) {\n      resolve(response.data);\n      console.log(response);\n    }).catch(function (_ref7) {\n      var response = _ref7.response;\n      errorMessage(context, response, SET_ERROR);\n      reject(response);\n    });\n  });\n}), _defineProperty(_actions, LOGOUT, function (context) {\n  context.commit(PURGE_AUTH);\n}), _actions);\nvar mutations = (_mutations = {}, _defineProperty(_mutations, SET_ERROR, function (state, error) {\n  state.errors = error;\n}), _defineProperty(_mutations, SET_MESSAGE, function (state, message) {\n  state.message = message;\n}), _defineProperty(_mutations, SET_AUTH, function (state, data) {\n  state.isAuthenticated = true;\n  state.errors = \"\";\n  JwtService.saveToken(data.access_token);\n  ApiService.setHeader();\n}), _defineProperty(_mutations, SET_USER, function (state, user) {\n  state.user = user;\n}), _defineProperty(_mutations, PURGE_AUTH, function (state) {\n  state.isAuthenticated = false;\n  state.user = {};\n  state.errors = \"\";\n  JwtService.destroyToken();\n}), _defineProperty(_mutations, \"updateField\", updateField), _mutations);\nexport default {\n  namespaced: true,\n  state: state,\n  actions: actions,\n  mutations: mutations,\n  getters: getters\n};",{"version":3,"sources":["/home/ebubeker/Desktop/programming/work tasks/goat/app/client/src/store/modules/auth.js"],"names":["ApiService","JwtService","ACTIVATE_ACCOUNT","CREATE_USER","FORGOT_PASSWORD","GET_USER","LOGIN","LOGOUT","RESET_PASSWORD","TEST_TOKEN","SET_AUTH","PURGE_AUTH","SET_ERROR","SET_USER","SET_MESSAGE","errorMessage","getField","updateField","state","errors","message","user","isAuthenticated","getToken","getters","currentUser","actions","context","credentials","Promise","resolve","reject","post","then","response","commit","data","catch","payload","get","msg","window","location","reload","console","log","mutations","error","saveToken","access_token","setHeader","destroyToken","namespaced"],"mappings":"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","sourcesContent":["import ApiService from \"../../services/api.service\";\nimport JwtService from \"../../services/jwt.service\";\n\nimport {\n  ACTIVATE_ACCOUNT,\n  CREATE_USER,\n  FORGOT_PASSWORD,\n  GET_USER,\n  LOGIN,\n  LOGOUT,\n  RESET_PASSWORD,\n  TEST_TOKEN\n} from \"../actions.type\";\nimport {\n  SET_AUTH,\n  PURGE_AUTH,\n  SET_ERROR,\n  SET_USER,\n  SET_MESSAGE\n} from \"../mutations.type\";\nimport { errorMessage } from \"../../utils/Helpers\";\nimport { getField, updateField } from \"vuex-map-fields\";\n\nconst state = {\n  errors: null,\n  message: \"\",\n  user: {},\n  isAuthenticated: !!JwtService.getToken()\n};\n\nconst getters = {\n  currentUser(state) {\n    return state.user;\n  },\n  isAuthenticated(state) {\n    return state.isAuthenticated;\n  },\n  getField\n};\n\nconst actions = {\n  [LOGIN](context, credentials) {\n    return new Promise((resolve, reject) => {\n      ApiService.post(\"/login/access-token\", credentials)\n        .then(response => {\n          context.commit(SET_AUTH, response.data);\n          resolve(response.data);\n        })\n        .catch(({ response }) => {\n          errorMessage(context, response, SET_ERROR);\n          reject(response);\n        });\n    });\n  },\n  [FORGOT_PASSWORD](context, payload) {\n    return new Promise((resolve, reject) => {\n      ApiService.post(`/password-recovery/${payload.get(\"email\")}`)\n        .then(response => {\n          context.commit(SET_MESSAGE, response.data.msg);\n          resolve(response.data);\n        })\n        .catch(({ response }) => {\n          errorMessage(context, response, SET_ERROR);\n          reject(response);\n        });\n    });\n  },\n  [RESET_PASSWORD](context, payload) {\n    return new Promise((resolve, reject) => {\n      ApiService.post(\"/reset-password\", payload)\n        .then(response => {\n          context.commit(SET_MESSAGE, response.data.msg);\n          resolve(response.data);\n        })\n        .catch(({ response }) => {\n          errorMessage(context, response, SET_ERROR);\n          reject(response);\n        });\n    });\n  },\n  [CREATE_USER](context, payload) {\n    return new Promise((resolve, reject) => {\n      ApiService.post(\"/users/demo\", payload)\n        .then(response => {\n          resolve(response.data);\n        })\n        .catch(({ response }) => {\n          errorMessage(context, response, SET_ERROR);\n          reject(response);\n        });\n    });\n  },\n  [TEST_TOKEN](context) {\n    return new Promise((resolve, reject) => {\n      ApiService.post(\"/login/test-token\")\n        .then(response => {\n          resolve(response.data);\n        })\n        .catch(({ response }) => {\n          //Token not valid. Logout and reload.\n          context.commit(PURGE_AUTH);\n          window.location.reload();\n          errorMessage(context, response, SET_ERROR);\n          reject(response);\n        });\n    });\n  },\n  [GET_USER](context) {\n    return new Promise((resolve, reject) => {\n      ApiService.get(\"/users/me\")\n        .then(response => {\n          context.commit(SET_USER, response.data);\n          resolve(response.data);\n        })\n        .catch(({ response }) => {\n          errorMessage(context, response, SET_ERROR);\n          reject(response);\n        });\n    });\n  },\n  [ACTIVATE_ACCOUNT](context, payload) {\n    return new Promise((resolve, reject) => {\n      ApiService.post(`/users/demo/activate?token=${payload[\"token\"]}`)\n        .then(response => {\n          resolve(response.data);\n          console.log(response);\n        })\n        .catch(({ response }) => {\n          errorMessage(context, response, SET_ERROR);\n          reject(response);\n        });\n    });\n  },\n  [LOGOUT](context) {\n    context.commit(PURGE_AUTH);\n  }\n};\n\nconst mutations = {\n  [SET_ERROR](state, error) {\n    state.errors = error;\n  },\n  [SET_MESSAGE](state, message) {\n    state.message = message;\n  },\n  [SET_AUTH](state, data) {\n    state.isAuthenticated = true;\n    state.errors = \"\";\n    JwtService.saveToken(data.access_token);\n    ApiService.setHeader();\n  },\n  [SET_USER](state, user) {\n    state.user = user;\n  },\n  [PURGE_AUTH](state) {\n    state.isAuthenticated = false;\n    state.user = {};\n    state.errors = \"\";\n    JwtService.destroyToken();\n  },\n  updateField\n};\n\nexport default {\n  namespaced: true,\n  state,\n  actions,\n  mutations,\n  getters\n};\n"]}]}