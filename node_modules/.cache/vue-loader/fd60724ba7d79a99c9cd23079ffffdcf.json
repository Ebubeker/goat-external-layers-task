{"remainingRequest":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ebubeker/Desktop/programming/work tasks/goat/app/client/src/components/core/UserSettings.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/src/components/core/UserSettings.vue","mtime":1657636289855},{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/cache-loader/dist/cjs.js","mtime":1657636581841},{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/babel-loader/lib/index.js","mtime":1657636581481},{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/vuetify-loader/lib/loader.js","mtime":1657636582513},{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/cache-loader/dist/cjs.js","mtime":1657636581841},{"path":"/home/ebubeker/Desktop/programming/work tasks/goat/app/client/node_modules/vue-loader/lib/index.js","mtime":1657636582549}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapGetters } from \"vuex\";\nimport { LOGOUT } from \"../../store/actions.type\";\nimport i18n from \"@/plugins/i18n\";\nimport { EventBus } from \"../../EventBus\";\nimport ApiService from \"../../services/api.service\";\nimport { mapFields } from \"vuex-map-fields\";\n\nexport default {\n  data: () => ({\n    languages: [\n      { flag: \"gb\", language: \"en\", title: \"English\" },\n      { flag: \"de\", language: \"de\", title: \"Deutsch\" }\n    ],\n    interactionType: \"languageChange\",\n    studyAreaId: null,\n    userCopy: {}\n  }),\n  computed: {\n    ...mapGetters(\"auth\", { user: \"currentUser\" }),\n    ...mapGetters(\"app\", {\n      appColor: \"appColor\",\n      occupiedStoragePercentage: \"occupiedStoragePercentage\",\n      uploadedStorageSize: \"uploadedStorageSize\"\n    }),\n    ...mapGetters(\"map\", {\n      studyAreaList: \"studyAreaList\"\n    }),\n    ...mapGetters(\"scenarios\", {\n      scenarios: \"scenarios\",\n      limitScenarios: \"limitScenarios\"\n    }),\n    ...mapGetters(\"isochrones\", {\n      calculations: \"calculations\"\n    }),\n    ...mapFields(\"auth\", {\n      userState: \"user\"\n    })\n  },\n  methods: {\n    changeLocale(locale) {\n      i18n.locale = locale;\n      //Close other interactions.\n      EventBus.$emit(\"ol-interaction-activated\", this.interactionType);\n      if (this.contextmenu) {\n        this.contextmenu.close();\n      }\n      EventBus.$emit(\"ol-interaction-stoped\", this.interactionType);\n      // Save language change\n      ApiService.put(\"/users/me/preference\", {\n        language_preference: locale\n      });\n    },\n    openContactSupportInNewTab() {\n      let url = \"https://plan4better.de/kontakt/\";\n      if (url) {\n        window.open(url, \"_blank\");\n      }\n    },\n    changeStudyArea(newStudyArea) {\n      if (newStudyArea === this.user.active_study_area_id) {\n        return;\n      }\n      if (this.calculations.length > 0) {\n        this.$refs.confirm\n          .open(\n            this.$t(\"userSettings.changeStudyAreaTitle\"),\n            this.$t(\"userSettings.changeStudyAreaMessageWarning\"),\n            { color: this.appColor.primary, icon: \"fa-solid fa-retweet\" }\n          )\n          .then(confirm => {\n            if (confirm) {\n              ApiService.put(\"/users/me/preference\", {\n                active_study_area_id: newStudyArea\n              }).then(() => {\n                window.location.reload();\n              });\n            } else {\n              this.studyAreaId = this.user.active_study_area_id;\n            }\n          });\n      } else {\n        ApiService.put(\"/users/me/preference\", {\n          active_study_area_id: newStudyArea\n        }).then(() => {\n          window.location.reload();\n        });\n      }\n    },\n    logout() {\n      this.$store.dispatch(`auth/${LOGOUT}`);\n      window.location.reload();\n    }\n  },\n  created() {\n    this.studyAreaId = this.user.active_study_area_id;\n    this.userCopy = JSON.parse(JSON.stringify(this.user)); // Workaround for logout clean\n  }\n};\n",{"version":3,"sources":["UserSettings.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2GA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UserSettings.vue","sourceRoot":"src/components/core","sourcesContent":["<template>\n  <v-flex xs12 sm8 md4>\n    <v-card class=\"px-16 mx-4 py-0 mb-2 fill-height\" flat>\n      <v-subheader> </v-subheader>\n\n      <v-row no-gutters class=\"mb-4\">\n        <v-col justify=\"center\" align=\"center\" cols=\"4\">\n          <v-row no-gutters justify=\"center\" align=\"center\" class=\"fill-height\">\n            <v-avatar size=\"60\">\n              <v-icon large class=\"fa-solid fa-user\"></v-icon>\n            </v-avatar>\n          </v-row>\n        </v-col>\n\n        <v-col cols=\"8\">\n          <v-row no-gutters align=\"center\" class=\"fill-height\">\n            <p class=\"mb-0 header-name\">\n              {{\n                `${user.name || userCopy.name}, ${user.surname ||\n                  userCopy.surname}`\n              }}\n            </p>\n            <p class=\"mb-0 sub-header\">\n              {{ `${user.email || userCopy.email}` }}\n            </p>\n          </v-row>\n        </v-col>\n      </v-row>\n\n      <v-divider></v-divider>\n      <v-select\n        class=\"mt-8\"\n        v-model=\"studyAreaId\"\n        :items=\"studyAreaList\"\n        item-value=\"id\"\n        item-text=\"name\"\n        :label=\"$t('userSettings.changeStudyAreaTitle')\"\n        @change=\"changeStudyArea\"\n      >\n      </v-select>\n      <v-divider></v-divider>\n      <v-select\n        class=\"mt-2\"\n        :value=\"$i18n.locale\"\n        :items=\"languages\"\n        item-value=\"language\"\n        item-text=\"title\"\n        :label=\"$t('userSettings.uiLanguage')\"\n        @change=\"changeLocale\"\n      >\n      </v-select>\n      <v-btn\n        style=\"text-transform:none;justify-content:left;\"\n        width=\"100%\"\n        class=\"mt-0\"\n        text\n        @click=\"openContactSupportInNewTab\"\n      >\n        <v-icon class=\"light-icon-color\" left>\n          fas fa-comments-question\n        </v-icon>\n        <span class=\"ml-2  theme--light\">\n          {{ $t(\"userSettings.contactSupport\") }}\n        </span>\n      </v-btn>\n      <br />\n      <v-btn\n        @click=\"logout\"\n        style=\"text-transform:none;justify-content:left;\"\n        width=\"100%\"\n        class=\"mt-3 mb-3\"\n        text\n      >\n        <v-icon class=\"light-icon-color\" left>\n          fas fa-arrow-right-from-bracket\n        </v-icon>\n        <span class=\"ml-2  theme--light\">\n          {{ $t(\"userSettings.logout\") }}\n        </span>\n      </v-btn>\n      <v-divider></v-divider>\n      <p class=\"mt-5 mb-1 sub-header\">\n        {{ (uploadedStorageSize / 1024).toFixed(2)\n        }}{{ $t(\"userSettings.mbOf\") }}\n        {{\n          parseInt(\n            user.storage ? user.storage / 1024 : userCopy.storage / 1024\n          )\n        }}{{ $t(\"userSettings.mbUsed\") }}\n      </p>\n      <v-progress-linear\n        height=\"2\"\n        :color=\"appColor.secondary\"\n        :value=\"occupiedStoragePercentage\"\n        class=\"mb-6 mt-0 pt-0\"\n      ></v-progress-linear>\n      <p class=\"mt-2 sub-header\">\n        {{ $t(\"userSettings.scenarios\") }}: {{ scenarios.length }} /\n        {{ limitScenarios }}\n      </p>\n    </v-card>\n    <v-spacer></v-spacer>\n    <confirm ref=\"confirm\"></confirm>\n  </v-flex>\n</template>\n\n<script>\nimport { mapGetters } from \"vuex\";\nimport { LOGOUT } from \"../../store/actions.type\";\nimport i18n from \"@/plugins/i18n\";\nimport { EventBus } from \"../../EventBus\";\nimport ApiService from \"../../services/api.service\";\nimport { mapFields } from \"vuex-map-fields\";\n\nexport default {\n  data: () => ({\n    languages: [\n      { flag: \"gb\", language: \"en\", title: \"English\" },\n      { flag: \"de\", language: \"de\", title: \"Deutsch\" }\n    ],\n    interactionType: \"languageChange\",\n    studyAreaId: null,\n    userCopy: {}\n  }),\n  computed: {\n    ...mapGetters(\"auth\", { user: \"currentUser\" }),\n    ...mapGetters(\"app\", {\n      appColor: \"appColor\",\n      occupiedStoragePercentage: \"occupiedStoragePercentage\",\n      uploadedStorageSize: \"uploadedStorageSize\"\n    }),\n    ...mapGetters(\"map\", {\n      studyAreaList: \"studyAreaList\"\n    }),\n    ...mapGetters(\"scenarios\", {\n      scenarios: \"scenarios\",\n      limitScenarios: \"limitScenarios\"\n    }),\n    ...mapGetters(\"isochrones\", {\n      calculations: \"calculations\"\n    }),\n    ...mapFields(\"auth\", {\n      userState: \"user\"\n    })\n  },\n  methods: {\n    changeLocale(locale) {\n      i18n.locale = locale;\n      //Close other interactions.\n      EventBus.$emit(\"ol-interaction-activated\", this.interactionType);\n      if (this.contextmenu) {\n        this.contextmenu.close();\n      }\n      EventBus.$emit(\"ol-interaction-stoped\", this.interactionType);\n      // Save language change\n      ApiService.put(\"/users/me/preference\", {\n        language_preference: locale\n      });\n    },\n    openContactSupportInNewTab() {\n      let url = \"https://plan4better.de/kontakt/\";\n      if (url) {\n        window.open(url, \"_blank\");\n      }\n    },\n    changeStudyArea(newStudyArea) {\n      if (newStudyArea === this.user.active_study_area_id) {\n        return;\n      }\n      if (this.calculations.length > 0) {\n        this.$refs.confirm\n          .open(\n            this.$t(\"userSettings.changeStudyAreaTitle\"),\n            this.$t(\"userSettings.changeStudyAreaMessageWarning\"),\n            { color: this.appColor.primary, icon: \"fa-solid fa-retweet\" }\n          )\n          .then(confirm => {\n            if (confirm) {\n              ApiService.put(\"/users/me/preference\", {\n                active_study_area_id: newStudyArea\n              }).then(() => {\n                window.location.reload();\n              });\n            } else {\n              this.studyAreaId = this.user.active_study_area_id;\n            }\n          });\n      } else {\n        ApiService.put(\"/users/me/preference\", {\n          active_study_area_id: newStudyArea\n        }).then(() => {\n          window.location.reload();\n        });\n      }\n    },\n    logout() {\n      this.$store.dispatch(`auth/${LOGOUT}`);\n      window.location.reload();\n    }\n  },\n  created() {\n    this.studyAreaId = this.user.active_study_area_id;\n    this.userCopy = JSON.parse(JSON.stringify(this.user)); // Workaround for logout clean\n  }\n};\n</script>\n\n<style scoped></style>\n"]}]}